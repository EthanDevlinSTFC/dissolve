# Input file written by Dissolve v0.5.0 at 12:01:55 on 07-01-2020.

#------------------------------------------------------------------------------#
#                                 Master Terms                                 #
#------------------------------------------------------------------------------#

Master
  Bond  'HW-OW'  Harmonic  4431.530     0.976
  Angle  'HW-OW-HW'  Harmonic   317.566   107.134
EndMaster

#------------------------------------------------------------------------------#
#                                   Species                                    #
#------------------------------------------------------------------------------#

Species 'Water'
  # Atoms
  Atom    1    O     5.139     5.968     5.000  'OW'    -0.82
  Atom    2    H     3.924     5.424     5.000  'HW'     0.41
  Atom    3    H     6.088     5.120     5.000  'HW'     0.41

  # Bonds
  Bond    1    2  @HW-OW
  Bond    3    1  @HW-OW

  # Angles
  Angle    3    1    2  @HW-OW-HW

  # Isotopologues
  Isotopologue  'Deuterated'  HW=2

  # Sites
  Site  'COM'
    Origin  1  2  3
    OriginMassWeighted  True
    XAxis  1
    YAxis  3
  EndSite
  Site  'O'
    Origin  1
  EndSite
  Site  'H1'
    Origin  2
  EndSite
  Site  'H2'
    Origin  3
  EndSite
EndSpecies

#------------------------------------------------------------------------------#
#                               Pair Potentials                                #
#------------------------------------------------------------------------------#

PairPotentials
  # Atom Type Parameters
  Parameters  OW  O  -8.200000e-01  LJ  6.503000e-01  3.165492e+00  0.000000e+00  0.000000e+00
  Parameters  HW  H  4.100000e-01  LJ  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
  Range  15.000000
  Delta  0.005000
  CoulombTruncation  Shifted
  ShortRangeTruncation  Shifted
EndPairPotentials

#------------------------------------------------------------------------------#
#                                Configurations                                #
#------------------------------------------------------------------------------#

Configuration  'Bulk'

  # Modules
  Generator
    Parameters
      Real  rho  1.000000e-01
    EndParameters
    Box
      Lengths  1.000000e+00  1.000000e+00  1.000000e+00
      Angles  9.000000e+01  9.000000e+01  9.000000e+01
      NonPeriodic  False
    EndBox
    AddSpecies
      Species  'Water'
      Population  '1000'
      Density  'rho'  atoms/A3
      Rotate  True
      Positioning  Random
    EndAddSpecies
  EndGenerator

  Temperature  300.000000

  # Modules
  # -- None
EndConfiguration

#------------------------------------------------------------------------------#
#                              Processing Layers                               #
#------------------------------------------------------------------------------#

Layer  'Evolve (Standard)'
  Frequency  1

  Module  MolShake  'MolShake01'
    Frequency  1

    Configuration  'Bulk'
    RotationStepSize   1.48184e+01
    TranslationStepSize   1.62518e-01
  EndModule

  Module  MD  'MD01'
    Frequency  5

    Configuration  'Bulk'
  EndModule

  Module  Energy  'Energy01'
    Frequency  1

    Configuration  'Bulk'
  EndModule
EndLayer

Layer  'RDF / Neutron / XRay'
  Frequency  5

  Module  RDF  'RDF01'
    Frequency  1

    Configuration  'Bulk'
    IntraBroadening  None
  EndModule

  # Test partial g(r) (unbound terms)
  Module  DataTest  'Partial g(r) (unbound)'
  ErrorType  RMSE
  Threshold  0.05
  Data1D  'Liquid//RDFs//OriginalGR//OW-OW//Unbound'  xy  'water-epsr25/water.EPSR.g01'
      Y  2
  EndData1D
  Data1D  'Liquid//RDFs//OriginalGR//OW-HW//Unbound'  xy  'water-epsr25/water.EPSR.g01'
      Y  4
  EndData1D
  Data1D  'Liquid//RDFs//OriginalGR//HW-HW//Unbound'  xy  'water-epsr25/water.EPSR.g01'
      Y  6
  EndData1D
  EndModule

  # Test partial g(r) (intramolecular terms)
  Module  DataTest  'Partial g(r) (bound)'
  ErrorType  RMSE
  Threshold  0.08
  Data1D  'Liquid//RDFs//OriginalGR//OW-OW//Bound'  xy  'water-epsr25/water.EPSR.y01'
      Y  2
  EndData1D
  Data1D  'Liquid//RDFs//OriginalGR//OW-HW//Bound'  xy  'water-epsr25/water.EPSR.y01'
      Y  4
  EndData1D
  Data1D  'Liquid//RDFs//OriginalGR//HW-HW//Bound'  xy  'water-epsr25/water.EPSR.y01'
      Y  6
  EndData1D
  EndModule

  Module  SQ  'SQ01'
    Frequency  1

    SourceRDFs  'RDF01'
    QBroadening  'OmegaDependentGaussian'  0.020000
  EndModule

  # Test partial S(Q) (unbound terms)
  Module  DataTest  'Partial S(Q) (unbound)'
    ErrorType  RMSE
    Threshold  0.04
    Data1D  'SQs//UnweightedSQ//OW-OW//Unbound'  xy  'water-epsr25/water.EPSR.f01'
      Y  2
    EndData1D
    Data1D  'SQs//UnweightedSQ//OW-HW//Unbound'  xy  'water-epsr25/water.EPSR.f01'
      Y  4
    EndData1D
    Data1D  'SQs//UnweightedSQ//HW-HW//Unbound'  xy  'water-epsr25/water.EPSR.f01'
      Y  6
    EndData1D
  EndModule

  # Test partial S(Q) (bound terms)
  Module  DataTest  'Partial S(Q) (bound)'
    ErrorType  RMSE
    Threshold  0.04
    Data1D  'SQs//UnweightedSQ//OW-OW//Bound'  xy  'water-epsr25/water.EPSR.s01'
      Y  2
    EndData1D
    Data1D  'SQs//UnweightedSQ//OW-HW//Bound'  xy  'water-epsr25/water.EPSR.s01'
      Y  4
    EndData1D
    Data1D  'SQs//UnweightedSQ//HW-HW//Bound'  xy  'water-epsr25/water.EPSR.s01'
      Y  6
    EndData1D
  EndModule

  Module  NeutronSQ  'H2O'
    Frequency  1

    SourceSQs  'SQ01'
    Isotopologue  'Water'  'Natural'  1.000000
    Reference  mint  'water-epsr25/SLS18498-H2O.mint01'
    EndReference
  EndModule
  
  # Test total neutron-weighted F(Q)
  Module  DataTest  'F(Q) H2O'
    ErrorType  RMSE
    Threshold  0.003
    Data1D  'H2O//WeightedSQ//Total'  xy  'water-epsr25/water.EPSR.u01'
      Y  2
    EndData1D
  EndModule

  Module  NeutronSQ  'D2O'
    Frequency  1

    SourceSQs  'SQ01'
    Isotopologue  'Water'  'Deuterated'  1.000000
    Reference  mint  'water-epsr25/SLS18502-D2O.mint01'
    EndReference
  EndModule

  Module  DataTest  'F(Q) D2O'
    ErrorType  RMSE
    Threshold  0.003
    Data1D  'D2O//WeightedSQ//Total'  xy  'water-epsr25/water.EPSR.u01'
      Y  4
    EndData1D
  EndModule

  Module  NeutronSQ  'HDO'
    Frequency  1

    SourceSQs  'SQ01'
    Exchangeable  HW
    Isotopologue  'Water'  'Natural'  1.000000
    Isotopologue  'Water'  'Deuterated'  1.000000
    Reference  mint  'water-epsr25/SLS18500-HDOHDO.mint01'
    EndReference
  EndModule

  Module  DataTest  'F(Q) HDO'
    ErrorType  RMSE
    Threshold  0.003
    Data1D  'HDO//WeightedSQ//Total'  xy  'water-epsr25/water.EPSR.u01'
      Y  6
    EndData1D
  EndModule

  Module  XRaySQ  'H2Ox'
    Frequency  1

    SourceSQs  'SQ01'
    # SaveFormFactors  On
    # SaveWeighted  On
    Normalisation  AverageOfSquares
    Reference  xy  'water-epsr25/SLS18500-HDOHasdasdDO.mint01'
  EndModule

EndLayer

Layer  'Refine (EPSR)'
  Frequency  5

  Module  EPSR  'EPSR01'
    Frequency  1
    EReq   6.00000e+00
    Target  'H2O'
    Target  'D2O'
    Target  'HDO'
  EndModule

  Module DataTest
    ErrorType  RMSE
    Threshold  0.02
    Data1D  'EPSR01//SimulatedFR//H2O'  xy  'water-epsr25/water.EPSR.x01'
      Y  2
    EndData1D
    Data1D  'EPSR01//SimulatedFR//D2O'  xy  'water-epsr25/water.EPSR.x01'
      Y  4
    EndData1D
    Data1D  'EPSR01//SimulatedFR//HDO'  xy  'water-epsr25/water.EPSR.x01'
      Y  6
    EndData1D
  EndModule

  Module DataTest
    ErrorType  RMSE
    Threshold  0.04
    Data1D  'EPSR01//EstimatedSQ//Default//OW-OW'  xy  'water-epsr25/water.EPSR.q01'
      Y  2
    EndData1D
    Data1D  'EPSR01//EstimatedSQ//Default//OW-HW'  xy  'water-epsr25/water.EPSR.q01'
      Y  4
    EndData1D
    Data1D  'EPSR01//EstimatedSQ//Default//HW-HW'  xy  'water-epsr25/water.EPSR.q01'
      Y  6
    EndData1D
  EndModule

EndLayer
